---
layout: post
current: post
cover: assets/images/ml_instanceVSmodel.png
navigation: True
title: "사례 기반 학습과 모델 기반학습"
date: 2020-04-29
tags: ML Scikit-Learn TensorFlow
class: post-template
subclass: 'post'
author: kwang
---

출처 및 저작권 : Hands-On Machine Learning with Scikit-Learn & TensorFlow
아래는 공부를 위해 필사를 하며 노트한 내용입니다.

1.3.3 사례 기반 학습과 모델 기반 학습

머신러닝 시스템은 어떻게 일반화되는가에 따라 분류할 수도 있습니다. 대부분의 머신러닝 작업은 예측을 만드는 것입니다. 이 말은 주어진 훈련 데이터로 학습하지만 훈련 데이터에서는 본 적 없는 새로운 데이터로 일반화 되어야 한다는 뜻입니다. 훈련 데이터에서 높은 성능을 내는 것이 좋지만 그게 전부는 아닙니다. 진짜 목표는 새로운 샘플에 잘 작동하는 모델입니다. 

일반화를 위한 두 가지 접근법은 사례 기반 학습과 모델 기반 학습입니다.

### 사례 기반 학습
아마도 가장 간단한 형태의 학습은 단순히 기억하는 것입니다. 스팸 필터를 이러한 방식으로 만들면 사용자가 스팸이라고 지정한 메일과 동일한 모든 메일을 스팸을 ㅗ분류합니다. 최악의 방법은 아니지만 최선도 아닙니다.

스팸 메일과 동일한 메일을 스팸이라고 지정하는 대신 스팸 메일과 매우 유사한 메일을 구분하도록 스팸 필터를 프로그램할 수 있습니다. 이렇게 하려면 두 메일 사이의 유사도(similarity)를 측정해야합니다. 두 메일 사이의 매우 간단한 유사도 측정 방법은 공통으로 포함한 단어의 수를 세는 것입니다. 스팸 메일과 공통으로 가지고 있는 단어가 많으면 스팸으로 분류합니다.

이를 사례 기반 학습 : Instance-based learning 이라고 합니다. 시승템이 사례를 기억함으로써 학습합니다. 그리고 유사도 측정을 사용해 새로운 데이터에 일반화합니다. 

### 모델 기반 학습
샘플로부터 일반화시키는 다른 방법은 이 샘플들의 모델을 만들어 예측에 사용하는 것입니다. 이를 모델 기반 학습 : model-based learning이라고 합니다.

예를 들어 돈이 사람을 행복하게 만드는지 알아본다고 가정합니다. OECD웹사이트에서 더 나은 삶의 지표 (Better Life Index)데이터와 IMF웹사이트에서 1인당 GDP통계를 내려받습니다. 두 데이터 테이블을 합치고 1인당 GDP로 정렬합니다. 

일부 국가를 무작위로 골라서 그래프를 그려봅시다.

여기서 어떤 경향을 볼 수 있습니다. 데이터가 흩어져 있지만(즉, 어느 정도 무작위성이 있지만) 삶의 만족도는 국가의 1인당 GDP가 증가할수록 거의 선형으로 같이 올라갑니다. 그러므로 1인당 GDP의 선형 함ㅁ수로 삶의 만족도를 모델링해보겠습니다. 이 단계를 모델 선택(model selection)이라고 합니다. 1인당 GDP라는 특성 하나를 가진 삶의 만족도에 대한 선형모델(Linear model)입니다.

    '''
    간단한 선형 모델
    삶의_만족도 = 세타0 + 세타1 * 1인당_GDP
    '''

이 모델은 두 개의 모델 파라미터 세타0과 세타1을 가집니다. 이 모델 파라미터를 조정하여 어떤 선형 함수를 표현하는 모델을 얻을 수 있습니다.


모델을 사용하기 전에 세타0과 세타1을 정의해야 합니다. 모델이 최상의 성능을 내도록 하는 값을 어떻게 알 수 있을까요? 이 질문에 대답하려면 측정 지푤흘 정해야 합니다. 모델이 얼마나 좋은지 측정하는 효용 함수(utility function 또는 적합도 함수 fitness function)를 정의하거나 얼마나 나쁜지 측정하는 비용함수(cost function)를 정의할 수 있습니다. 선형 회귀에서 보통 선형 모델의 예측과 훈련 데이터 사이의 거리를 재는 비용함수를 사용합니다. 이 거리를 최소화 하는 것이 목표입니다.

여기에서 선형 회귀(Linear Regression)알고리즘이 등장합니다. 알고리즘에 훈련 데이터를 공급하면 데이터에 가장 잘 맞는 선형 모델의 파라미터를 찾습니다. 이를 모델을 훈련training시킨다고 말합니다. 이 경우에는 알고리즘ㅇ ㅣ최적의 파라미터로 세타0 = 4.85와 세타1=4.91 * 10의 -5승 을 찾았습니다. 

그림에서 볼 수 있듯이 모델이 훈련 데이터에 (선형 모델로서) 가능한 한 가깝게 맞춰졌습니다. 이제 이 모델을 사용해 예측을 할 수 있습니다. 예를 들어 OECD데이터에 없는 키프로스 사람들이 얼마나 행복한지 알아보려면 이 모델을 사용해 예측할 수 있습니다. 키프로스의 1인당 GDP를 보면 22.587ekffjdlamfh dlfmf ahepfdp wjrdydgo 4.85 + 22,587 * 4.91 *10의 -5승 = 5.96과 같이 삶의 만족도를 계산합니다. 


아래 예제의 파이썬 코드는 데이터를 로드하고 준비한 다음 산점도scatterplot을 그려 시각화하고 선형 모델을 훈련하여 예측하는 과정을 보여줍니다.