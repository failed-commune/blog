---
layout: post
current: post
cover: assets/images/bear.jpg
navigation: True
title: "핸즈온 머신러닝"
date: 2020-04-16
tags: ML Scikit-Learn TensorFlow
class: post-template
subclass: 'post'
author: kwang
---

1.1 머신러닝이란?
머신러닝은 데이터로부터 학습하도록 컴퓨터를 프로그래밍하는 과학입니다.
조금 더 일반적인 정의는 다음과 같습니다.\
    [머신러닝은] 명시적인 프로그래밍 없이 컴퓨터가 학습하는 능력을 갖추게 하는 연구분야다. - 아서 사무엘, 1959

조금 더 공학적인 정의는 다음과 같습니다.
    어떤 작업 T에 대한 컴퓨터 프로그램의 성능을 P로 측정했ㅇ을 때 경험 E로 인해 성능이 향상됐다면, 이 컴퓨터 프로그램은 작업 T와 성능 측정 P에 대해 경험 E로 학습한 것이다. - 톰 미첼, 1997

예를 들어 스팸 필터는 (사용자가 스팸이라고 지정한)스팸 메일과 일반 메일의 샘플을 이용해 스팸 메일 구분법을 배울 수 있는 머신러닝 프로그램입니다. 시스템이 학습하는 데 사용하는 샘플을 트레이닝 셋이라고 하고 각 훈련 데이터를 트레이닝 인스턴스  또는 샘플이라고 합니다. 이 경우 작업 T는 새로운 메일이 스팸인지 구분하는 것이고, 경험 E는 트레이닝 데이터이며, 성능 측정 P는 직접 정의해야 합니다. 예를 들면 정확히 분류된 메일의 비율을 P로 사용할 수 있습니다. 이 성능 측정을 정확도(accuracy)라고 부르며 분류 작업에 자주 사용됩니다. 

위키백과 문서를 모두 내려받으면 컴퓨터는 아주 많은 데이터를 갖게 됩니다. 그렇다고 해서 어떤 작업이 갑자기 좋아지는 것은 아닙니다. 그러므로 이는 머신러닝이 아닙니다.


---
1.2 왜 머신러닝을 사용하는가?

전통적인 프로그래밍 기법을 사용해 어떻게 스팸 필터를 만들 수 있을지 생각해 봅신다.

    1. 먼저 스팸에 어던 단어들이 주로 나타나는지 살펴봅니다. '4U', '신용카드', '무료', '굉장한'과 같은 단어나 구절이 제목에 많이 나타나는 경향이 있다는 것을 알 수 있습니다. 어쩌면 보낸이의 이름이나 메일 주소, 본문 등에서 다른 패턴을 감지할 수도 있습니다.
    2. 발견한 각 패턴을 감지하는 알고리즘을 작성하여 프로그램이 이런 패턴을 발견했을 때 그 메일을 스팸으로 분류하게 합니다.
    3. 프로그램을 테스트하고 충분한 성능이 나올 때까지 1단계와 2단계를 반복합니다.

전통적인 접근 방법에서는 문제가 단순하지 않아 규칙이 점점 길고 복잡해 지므로 유지 보수하기 매우 힘들어집니다.

반면 머신러닝 기법에 기반을 둔 스팸 필터는 일반 메일에 비해 스팸에 자주 나타나는 패턴을 감지하여 어떤 단어와 구절이 스팸 메일을 판단하는 데 좋은 기준인지 자동으로 학습힙니다. 그러므로 프로그램이 훨씬 짧아지고 유지 보수하기 쉬우며 대부분 정확도가 더 높습니다. 더군다나 스팸 메일 발송자가 '4U'를 포함한 모든 메일이 차단된다는 것을 안다면 '4U' 대신 'For U'를 쓰기 시작할지도 모릅니다. 전통적인 프로그래밍 방식의 스팸 필터는 'For U' 메일을 구분하기 위해 수정이 필요합니다. 스팸 메일 발송자가 스팸 필터에 대항해 계속 단어를 바꾸면 영원히 새로운 규칙을 추가해야 합니다.

하지만 머신러닝 기반의 스팸 필터는 사용자가 스팸으로 지정한 메일에 유독 'For U'가 자주 나타나는 것을 자동으로 인식하고 별도의 작업을 하지 않아도 자동으로 이 단어를 스팸으로 분류합니다.

머신러닝이 유용한 또 다른 분야는 전통적인 방식으로는 너무 복잡하거나 알려진 알고리즘이 없는 문제입니다. 음성 인식(speech recognition)을 예로 들 수 있습니다. 'one'과 'two' 두 단어를 구분하는 프로그램을 작성한다고 합시다. 단어 'two'는 높은 피치pitch의 사운드 'T'로 시작하므로 높은 피치의 사운드 강도를 측정하는 알고리즘을 하드코딩해서 'one'과 'two'를 구분할 수도 있습니다. 당연히 이  방법은 소음이 있는 환경에서 수백만 명이 말하는 여러 언어로 된 수천개의 단어를 구분하는 것으로 확장하기 어렵습니다. 각 단어를 녹음한 샘플을 사용해 스스로 학습하는 알고리즘을 작성하는 것이 현재 가장 좋은 솔루션입니다.

우리는 머신러닝을 통해 배울 수도 있습니다. 즉 머신러닝 알고리즘이 학습한 것을 조사할 수 있습니다.(어떤 알고리즘은 이렇게 하기 어렵습니다.). 예를 들어 스팸 필터가 충분한 스팸 메일로 훈련되었다면 스팸을 예측하는 데 가장 좋은 단어와 단어의 조합이 무엇인지 확인할 ㅅ ㅜ 있습니다. 가끔 예상치 못한 연관 관계나 새로운 추세가 발견되기도 해서 해당 문제를 더 잘 이해하도록 도와줍니다. 

머신러닝 기술을 적용해서 대용량의 데이터를 분석하면 겉으로는 보이지 않던 패턴을 발견할 수 있습니다. 이를 데이터 마이닝(data mining)이라고 합니다.

요약하자면 머신러닝은 다음 분야에 뛰어납니다.
    - 기존 솔루션으로 많은 수동 조정과 규칙이 필요한 문제: 하나의 머신러닝 모델이 코드를 간단하고 더 잘 수행되도록 할 수 있습니다.
    - 전통적인 방식으로는 전혀 해결 방법이 없는 복잡한 문제: 가장 뛰어난 머신러닝 기법으로 해결 방법을 찾을 수 있습니다.
    - 유동적인 환경: 머신러닝 시스템은 새로운 데이터에 적응할 수 있습니다.
    - 복잡한 문제와 대량의 데이터에서 통찰 얻기

---
1.3 머신러닝 시스템의 종류
머신러닝 시스템의 종류는 굉장히 많으므로 다음을 기준으로 넓은 범주에서 분류하면 도움이 됩니다. 
    1. 지도 학습과 비지도 학습
        머신러닝 시스템을 '학습하는 동안의 감독 형태나 정보량'에 따라 분류할 수 있습니다. 지도 학습, 비지도 학습, 준지도 학습, 강화 학습 등 네 가지 주요 범주가 있습니다.
        
        *지도 학습 : Supervised Learning*
        알고리즘에 주입하는 훈련 데이터에 레이블이라는 원하는 답이 포함됩니다.

        분류(Classification)가 전형적인 지도 학습 작업이며, 스팸 필터가 좋은 예입니다. 스팸 필터는 많은 메일 샙ㅁ플과 소속 정보 (스팸인지 아닌지)로 훈련되어야 하며 어떻게 새 메일을 분류할지 학습해야 합니다. 

        또 다른 전형적인 작업은 예측 변수(Predictor variable)라 부르는 특성(feature)-ex. 주행거리, 연식, 브랜드 등을 이용해 중고차 가격 같은 타깃 수치를 예측하는 것입니다. 이런 종류의 작업을 회귀(regression)이라고 부릅니다. 시스템을 훈련시키려면 예측 변수와 레이블(중고차 가격)이 포함된 중고차 데이터가 많이 필요합니다.

        cf. 머신러닝에서 속성(attribute)은 데이터 타입(예를 들면 주행거리)을 말합니다. 특성은 문맥에 따라 여러 의미를 갖지만 일반적으로 속성과 값이 합쳐진 것을 의미합니다.(예를 들면 주행거리 = 15,000). 하지만 많은 사람이 속성과 특성을 구분하지 않고 사용합니다. 

        일부 회귀 알고리즘은 분류에 사용할 수도 있고 또 반대의 경우도 있습니다. 예를 들어 분류에 널리 쓰이는 로지스틱 회귀는 클래스에 속할 확률을 출력합니다.(예를 들면 스팸일 가능성 20%)

        다음은 가장 중요한 지도 학습 알고리즘들입니다. 
            - k-최근접 이웃(k-Nearest Neighbors)
            - 선형 회귀(Linear Regression)
            - 로지스틱 회귀 